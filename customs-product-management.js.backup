// å…³åŠ¡å•†å“ç®¡ç†é¡µé¢JavaScriptåŠŸèƒ½
document.addEventListener('DOMContentLoaded', function() {
    // åˆå§‹åŒ–é¡µé¢
    initializePage();
});

// å…¨å±€å˜é‡
let currentPage = 1;
let totalPages = 1;
let totalRecords = 0;
let pageSize = 20;
let currentCountry = 'china';
let currentStatus = 'all';
let searchParams = {};

// å…¨å±€æ•°æ®å­˜å‚¨ - è§£å†³æ•°æ®æŒä¹…åŒ–é—®é¢˜
let globalDataStore = {};

// æŠ˜å /å±•å¼€æŸ¥è¯¢è¡¨å•åŠŸèƒ½
function toggleSearchForm() {
    console.log('toggleSearchForm å‡½æ•°è¢«è°ƒç”¨');
    
    const searchForm = document.querySelector('.search-form');
    const toggleText = document.getElementById('toggle-text');
    const toggleIcon = document.getElementById('toggle-icon');
    
    console.log('searchForm:', searchForm);
    console.log('toggleText:', toggleText);
    console.log('toggleIcon:', toggleIcon);
    
    if (searchForm && toggleText && toggleIcon) {
        searchForm.classList.toggle('collapsed');
        
        console.log('collapsed class added:', searchForm.classList.contains('collapsed'));
        
        if (searchForm.classList.contains('collapsed')) {
            toggleText.textContent = 'å±•å¼€';
            toggleIcon.textContent = 'â–¼';
            console.log('è®¾ç½®ä¸ºå±•å¼€çŠ¶æ€');
        } else {
            toggleText.textContent = 'æ”¶èµ·';
            toggleIcon.textContent = 'â–²';
            console.log('è®¾ç½®ä¸ºæ”¶èµ·çŠ¶æ€');
        }
    } else {
        console.log('æœªæ‰¾åˆ°å¿…è¦çš„DOMå…ƒç´ ');
    }
}

// ç”Ÿæˆæ“ä½œæŒ‰é’®
function generateActionButtons(row) {
    const buttons = [];
    
    // æ ¹æ®çŠ¶æ€å†³å®šæ˜¾ç¤ºå“ªäº›æŒ‰é’®
    const customsStatus = row.customsStatus;
    const certStatus = row.certStatus;
    const productStatus = row.productStatus;
    
    // å…³åŠ¡è¯„ä¼°æŒ‰é’®é€»è¾‘
    if (customsStatus === 'pending-submit') {
        // å¾…æäº¤çŠ¶æ€ï¼šæ˜¾ç¤ºå…³åŠ¡è¯„ä¼°æŒ‰é’®
        buttons.push(`<a href="javascript:void(0)" class="action-btn customs-btn" onclick="performCustomsEvaluation(getCurrentRowData('${row.domesticSku}'))">å…³åŠ¡è¯„ä¼°</a>`);
    } else if (customsStatus === 'confirmed') {
        // å·²ç¡®è®¤çŠ¶æ€ï¼šå¯ä»¥é‡æ–°è¯„ä¼°ï¼Œéœ€è¦å¡«å†™è°ƒæ•´åŸå› 
        buttons.push(`<a href="javascript:void(0)" class="action-btn customs-btn" onclick="performCustomsEvaluation(getCurrentRowData('${row.domesticSku}'))">é‡æ–°å…³åŠ¡è¯„ä¼°</a>`);
    }
    
    // å…³åŠ¡ç¡®è®¤æŒ‰é’®ï¼ˆåªæœ‰åœ¨å…³åŠ¡è¯„ä¼°çŠ¶æ€ä¸ºå¾…ç¡®è®¤æ—¶æ˜¾ç¤ºï¼‰
    if (customsStatus === 'pending-confirm') {
        buttons.push(`<a href="javascript:void(0)" class="action-btn confirm-btn" onclick="performCustomsConfirmation(getCurrentRowData('${row.domesticSku}'))">å…³åŠ¡ç¡®è®¤</a>`);
    }
    
    // è®¤è¯è¯„ä¼°æŒ‰é’®é€»è¾‘
    if (certStatus === 'pending-submit') {
        buttons.push(`<a href="javascript:void(0)" class="action-btn cert-btn" onclick="performCertEvaluation(getCurrentRowData('${row.domesticSku}'))">è®¤è¯è¯„ä¼°</a>`);
    } else if (certStatus === 'submitted') {
        // å·²æäº¤çŠ¶æ€ï¼šå¯ä»¥é‡æ–°è¯„ä¼°ï¼Œéœ€è¦å¡«å†™è°ƒæ•´åŸå› 
        buttons.push(`<a href="javascript:void(0)" class="action-btn cert-btn" onclick="performCertEvaluation(getCurrentRowData('${row.domesticSku}'))">é‡æ–°è®¤è¯è¯„ä¼°</a>`);
    }
    
    // åˆ†é…æœåŠ¡å•†æŒ‰é’®
    buttons.push(`<a href="javascript:void(0)" class="action-btn assign-btn" onclick="performAssignProvider('${row.domesticSku}')">åˆ†é…æœåŠ¡å•†</a>`);
    
    // è¯¦æƒ…æŒ‰é’®
    buttons.push(`<a href="javascript:void(0)" class="action-btn detail-btn" onclick="viewProductDetail('${row.domesticSku}')">è¯¦æƒ…</a>`);
    
    // åˆ é™¤æŒ‰é’®
    buttons.push(`<a href="javascript:void(0)" class="action-btn delete-btn" onclick="deleteProduct('${row.domesticSku}')">åˆ é™¤</a>`);
    
    // å°†æŒ‰é’®åˆ†æˆä¸¤è¡Œï¼Œæ¯è¡Œæœ€å¤š3ä¸ªæŒ‰é’®
    const firstRow = buttons.slice(0, 3);
    const secondRow = buttons.slice(3);
    
    let html = '<div class="action-buttons">';
    if (firstRow.length > 0) {
        html += '<div class="action-row">' + firstRow.join('') + '</div>';
    }
    if (secondRow.length > 0) {
        html += '<div class="action-row">' + secondRow.join('') + '</div>';
    }
    html += '</div>';
    
    return html;
}

// æ¸²æŸ“è¡¨æ ¼æ•°æ®
function renderTableData(response) {
    const tableBody = document.getElementById('table-body');
    const headers = countryTableHeaders[currentCountry] || countryTableHeaders.china;
    
    if (!response.data || response.data.length === 0) {
        // æ˜¾ç¤ºç©ºæ•°æ®çŠ¶æ€
        tableBody.innerHTML = `
            <tr class="empty-row">
                <td colspan="${headers.length}" class="empty-message">
                    <div class="empty-content">
                        <div class="empty-icon">ğŸ“¦</div>
                        <div class="empty-text">æš‚æ— æ•°æ®</div>
                        <div class="empty-desc">è¯·è°ƒæ•´æŸ¥è¯¢æ¡ä»¶åé‡æ–°æœç´¢</div>
                    </div>
                </td>
            </tr>
        `;
        
        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        totalRecords = 0;
        totalPages = 1;
        currentPage = 1;
        return;
    }
    
    // æ¸²æŸ“æ•°æ®è¡Œ
    let bodyHtml = '';
    response.data.forEach(row => {
        bodyHtml += '<tr>';
        headers.forEach(header => {
            let classes = [];
            let cellContent = row[header.key] || '';
            
            if (header.fixed) {
                classes.push('fixed-column');
                if (header.checkbox) {
                    classes.push('checkbox-column');
                } else if (header.fixed === 'left') {
                    classes.push('sku-column');
                } else if (header.fixed === 'right') {
                    classes.push('action-column');
                }
            }
            if (header.numeric) {
                classes.push('numeric');
            }
            
            // ç‰¹æ®Šå¤„ç†æŸäº›åˆ—çš„æ˜¾ç¤º
            if (header.checkbox) {
                cellContent = `<input type="checkbox" class="row-checkbox" value="${row.domesticSku}">`;
            } else if (header.key === 'actions') {
                cellContent = generateActionButtons(row);
            } else if (header.key === 'isControlled') {
                cellContent = cellContent === 'æ˜¯' ?
                    '<span class="control-status control-yes">æ˜¯</span>' :
                    '<span class="control-status control-no">å¦</span>';
            } else if (header.key === 'hasOrder') {
                // å¤„ç†"æ˜¯å¦äº§ç”Ÿè®¢å•"å­—æ®µçš„ä¸­æ–‡æ˜¾ç¤º
                if (cellContent === 'æ˜¯') {
                    cellContent = '<span class="order-status order-yes">æ˜¯</span>';
                } else if (cellContent === 'å¦') {
                    cellContent = '<span class="order-status order-no">å¦</span>';
                } else {
                    cellContent = '<span class="order-status order-unknown">-</span>';
                }
            } else if (header.key.includes('Status')) {
                cellContent = `<span class="status-badge status-${cellContent}">${getStatusText(cellContent)}</span>`;
            }
            
            bodyHtml += `<td class="${classes.join(' ')}">${cellContent}</td>`;
        });
        bodyHtml += '</tr>';
    });
    
    tableBody.innerHTML = bodyHtml;
    
    // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
    totalRecords = response.total;
    totalPages = Math.ceil(totalRecords / pageSize);
    currentPage = response.page;
}

// è·å–çŠ¶æ€æ–‡æœ¬
function getStatusText(status) {
    const statusMap = {
        // å…³åŠ¡è¯„ä¼°çŠ¶æ€
        'pending-submit': 'å¾…æäº¤',
        'pending-confirm': 'å¾…ç¡®è®¤',
        'confirmed': 'å·²ç¡®è®¤',
        
        // è®¤è¯è¯„ä¼°çŠ¶æ€
        'pending': 'å¾…æäº¤',
        'submitted': 'å·²æäº¤',
        
        // å•†å“è¯„ä¼°çŠ¶æ€
        'active': 'å·²ç”Ÿæ•ˆ',
        'inactive': 'æœªç”Ÿæ•ˆ',
        'pending': 'å¾…ç”Ÿæ•ˆ',
        
        // å…¶ä»–çŠ¶æ€
        'processing': 'å¤„ç†ä¸­',
        'rejected': 'å·²æ‹’ç»'
    };
    return statusMap[status] || status;
}

// å•†å“è¯„ä¼°çŠ¶æ€è”åŠ¨é€»è¾‘
function updateProductStatus(row) {
    const customsStatus = row.customsStatus;
    const certStatus = row.certStatus;
    
    // å•†å“è¯„ä¼°çŠ¶æ€è”åŠ¨è§„åˆ™ï¼šæ‰€æœ‰å›½å®¶éƒ½éœ€è¦å…³åŠ¡è¯„ä¼°çŠ¶æ€ä¸ºå·²ç¡®è®¤ ä¸” è®¤è¯è¯„ä¼°çŠ¶æ€ä¸ºå·²æäº¤
    if (customsStatus === 'confirmed' && certStatus === 'submitted') {
        return 'active'; // å·²ç”Ÿæ•ˆ
    }
    
    return 'inactive'; // æœªç”Ÿæ•ˆ
}

// æ£€æŸ¥æ˜¯å¦å¯ä»¥è¿›è¡Œå•†å“è¯„ä¼°çŠ¶æ€æ›´æ–°
function canUpdateProductStatus(customsStatus, certStatus, country) {
    // æ‰€æœ‰å›½å®¶éƒ½éœ€è¦å…³åŠ¡è¯„ä¼°çŠ¶æ€ä¸ºå·²ç¡®è®¤ ä¸” è®¤è¯è¯„ä¼°çŠ¶æ€ä¸ºå·²æäº¤
    return customsStatus === 'confirmed' && certStatus === 'submitted';
}

// çŠ¶æ€æµè½¬æ“ä½œå‡½æ•°
function performCustomsEvaluation(row) {
    console.log('æ‰§è¡Œå…³åŠ¡è¯„ä¼°æ“ä½œï¼Œå•†å“SKU:', row.domesticSku);
    
    if (row.customsStatus === 'pending-submit') {
        // åˆæ¬¡å…³åŠ¡è¯„ä¼°ï¼šå¾…æäº¤ -> å¾…ç¡®è®¤
        row.customsStatus = 'pending-confirm';
        console.log('å…³åŠ¡è¯„ä¼°å·²æäº¤ï¼ŒçŠ¶æ€å˜æ›´ä¸ºå¾…ç¡®è®¤');
    } else if (row.customsStatus === 'confirmed') {
        // é‡æ–°å…³åŠ¡è¯„ä¼°ï¼šå·²ç¡®è®¤ -> å·²ç¡®è®¤ï¼ˆéœ€è¦å¡«å†™è°ƒæ•´åŸå› ï¼‰
        const reason = prompt('è¯·å¡«å†™è°ƒæ•´åŸå› ï¼š');
        if (reason && reason.trim()) {
            row.adjustmentReason = reason.trim();
            // ç›´æ¥è§¦å‘å•†å“è¯„ä¼°çŠ¶æ€ç”Ÿæ•ˆ
            row.productStatus = updateProductStatus(row);
            console.log('é‡æ–°å…³åŠ¡è¯„ä¼°å®Œæˆï¼Œå•†å“è¯„ä¼°çŠ¶æ€å·²æ›´æ–°');
        } else {
            console.log('æœªå¡«å†™è°ƒæ•´åŸå› ï¼Œæ“ä½œå–æ¶ˆ');
            return;
        }
    }
    
    // é‡æ–°æ¸²æŸ“å½“å‰æ•°æ®
    switchCountryTab(currentCountry);
}

function performCustomsConfirmation(row) {
    console.log('æ‰§è¡Œå…³åŠ¡ç¡®è®¤æ“ä½œï¼Œå•†å“SKU:', row.domesticSku);
    
    if (row.customsStatus === 'pending-confirm') {
        // å…³åŠ¡ç¡®è®¤ï¼šå¾…ç¡®è®¤ -> å·²ç¡®è®¤
        row.customsStatus = 'confirmed';
        
        // æ›´æ–°å•†å“è¯„ä¼°çŠ¶æ€
        row.productStatus = updateProductStatus(row);
        
        console.log('å…³åŠ¡ç¡®è®¤å®Œæˆï¼Œå•†å“è¯„ä¼°çŠ¶æ€å·²æ›´æ–°');
        
        // é‡æ–°æ¸²æŸ“å½“å‰æ•°æ®
        switchCountryTab(currentCountry);
    }
}

function performCertEvaluation(row) {
    console.log('æ‰§è¡Œè®¤è¯è¯„ä¼°æ“ä½œï¼Œå•†å“SKU:', row.domesticSku);
    
    if (row.certStatus === 'pending-submit') {
        // åˆæ¬¡è®¤è¯è¯„ä¼°ï¼šå¾…æäº¤ -> å·²æäº¤
        row.certStatus = 'submitted';
        console.log('è®¤è¯è¯„ä¼°å·²æäº¤');
    } else if (row.certStatus === 'submitted') {
        // é‡æ–°è®¤è¯è¯„ä¼°ï¼šéœ€è¦å¡«å†™è°ƒæ•´åŸå› 
        const reason = prompt('è¯·å¡«å†™è°ƒæ•´åŸå› ï¼š');
        if (reason && reason.trim()) {
            row.adjustmentReason = reason.trim();
            console.log('é‡æ–°è®¤è¯è¯„ä¼°å®Œæˆ');
        } else {
            console.log('æœªå¡«å†™è°ƒæ•´åŸå› ï¼Œæ“ä½œå–æ¶ˆ');
            return;
        }
    }
    
    // æ›´æ–°å•†å“è¯„ä¼°çŠ¶æ€
    row.productStatus = updateProductStatus(row);
    
    // é‡æ–°æ¸²æŸ“å½“å‰æ•°æ®
    switchCountryTab(currentCountry);
}

// è·å–æŒ‡å®šSKUçš„è¡Œæ•°æ®
function getCurrentRowData(domesticSku) {
    const currentData = staticMockData[currentCountry];
    return currentData.find(row => row.domesticSku === domesticSku);
}
// å›½å®¶TABåˆ‡æ¢åŠŸèƒ½
// åˆ‡æ¢å›½å®¶TAB - ç®€åŒ–ç‰ˆæœ¬ä½¿ç”¨é™æ€æ•°æ®
function switchCountryTab(country) {
    console.log('switchCountryTab called with country:', country);
    currentCountry = country;
    console.log('currentCountry updated to:', currentCountry);
    setActiveCountryTab(country);
    
    // æ›´æ–°è¡¨æ ¼å¤´éƒ¨
    const tableHeader = document.getElementById('table-header');
    if (tableHeader) {
        const headers = countryTableHeaders[currentCountry] || countryTableHeaders.china;
        
        let headerHtml = '<tr>';
        headers.forEach(header => {
            let classes = [];
            if (header.fixed) {
                classes.push('fixed-column');
                if (header.checkbox) {
                    classes.push('checkbox-column');
                } else if (header.fixed === 'left') {
                    classes.push('sku-column');
                } else if (header.fixed === 'right') {
                    classes.push('action-column');
                }
            }
            if (header.numeric) {
                classes.push('numeric');
            }
            
            // ç‰¹æ®Šå¤„ç†å¤é€‰æ¡†åˆ—
            if (header.checkbox) {
                headerHtml += `<th class="${classes.join(' ')}">
                    <input type="checkbox" id="select-all" onchange="toggleSelectAll(this)">
                </th>`;
            } else {
                headerHtml += `<th class="${classes.join(' ')}">${header.title}</th>`;
            }
        });
        headerHtml += '</tr>';
        
        tableHeader.innerHTML = headerHtml;
    }
    
    // ç›´æ¥è·å–é™æ€æ•°æ®å¹¶æ¸²æŸ“
    let data = staticMockData[country] || [];
    
    // æ ¹æ®æŸ¥è¯¢æ¡ä»¶è¿‡æ»¤æ•°æ®
    if (searchParams && Object.keys(searchParams).length > 0) {
        data = data.filter(item => {
            for (let key in searchParams) {
                if (searchParams[key] && searchParams[key] !== '') {
                    const itemValue = String(item[key] || '').toLowerCase();
                    const searchValue = String(searchParams[key]).toLowerCase();
                    if (!itemValue.includes(searchValue)) {
                        return false;
                    }
                }
            }
            return true;
        });
    }
    
    // æ ¹æ®çŠ¶æ€TABè¿‡æ»¤æ•°æ®
    if (currentStatus !== 'all') {
        data = data.filter(item => {
            switch (currentStatus) {
                case 'pending-submit':
                    return item.customsStatus === 'pending-submit';
                case 'pending-confirm':
                    return item.customsStatus === 'pending-confirm';
                case 'confirmed':
                    return item.customsStatus === 'confirmed';
                case 'cert-pending':
                    return item.certStatus === 'pending-submit';
                case 'element-pending':
                    return item.hasOrder === 'æ˜¯' && item.elementStatus === 'pending';
                default:
                    return true;
            }
        });
    }
    
    const total = data.length;
    const startIndex = (currentPage - 1) * pageSize;
    const endIndex = startIndex + pageSize;
    const pageData = data.slice(startIndex, endIndex);
    
    const mockData = {
        data: pageData,
        total: total,
        page: currentPage,
        pageSize: pageSize
    };
    
    renderTableData(mockData);
    updatePagination();
}



// æ ¹æ®æœç´¢å‚æ•°è¿‡æ»¤æ•°æ®
function filterDataBySearchParams(data, params) {
    if (!params || Object.keys(params).length === 0) {
        return data;
    }
    
    return data.filter(item => {
        for (let key in params) {
            if (params[key] && item[key]) {
                if (item[key].toString().toLowerCase().indexOf(params[key].toLowerCase()) === -1) {
                    return false;
                }
            }
        }
        return true;
    });
}

// æ ¹æ®çŠ¶æ€è¿‡æ»¤æ•°æ®
function filterDataByStatus(data, status) {
    if (!status || status === 'all') {
        return data;
    }
    
    return data.filter(item => {
        if (status === 'pending') {
            return item.status === 'å¾…å®¡æ ¸' || item.status === 'Pending Review';
        } else if (status === 'approved') {
            return item.status === 'å·²é€šè¿‡' || item.status === 'Approved';
        } else if (status === 'rejected') {
            return item.status === 'å·²æ‹’ç»' || item.status === 'Rejected';
        }
        return true;
    });
}

// è®¾ç½®æ´»è·ƒå›½å®¶TAB
function setActiveCountryTab(country) {
    const countryTabs = document.querySelectorAll('.tab-btn');
    countryTabs.forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('data-country') === country) {
            tab.classList.add('active');
        }
    });
}
// Select placeholderåŠŸèƒ½
function initSelectPlaceholders() {
    const selects = document.querySelectorAll('select[data-placeholder]');
    
    selects.forEach(select => {
        const placeholder = select.getAttribute('data-placeholder');
        
        // ç¡®ä¿selectæ²¡æœ‰é€‰ä¸­ä»»ä½•å€¼
        select.value = '';
        
        // è®¾ç½®placeholderæ ·å¼å’Œæ–‡æœ¬æ˜¾ç¤º
        function updatePlaceholderDisplay() {
            if (select.value === '') {
                // æ˜¾ç¤ºplaceholderæ ·å¼
                select.style.color = '#999';
                select.setAttribute('data-showing-placeholder', 'true');
            } else {
                // æ˜¾ç¤ºæ­£å¸¸é€‰ä¸­å€¼æ ·å¼
                select.style.color = '#333';
                select.removeAttribute('data-showing-placeholder');
            }
        }
        
        // ç›‘å¬å˜åŒ–äº‹ä»¶
        select.addEventListener('change', updatePlaceholderDisplay);
        select.addEventListener('focus', function() {
            if (this.value === '') {
                this.style.color = '#666'; // ç„¦ç‚¹æ—¶ç¨å¾®æ·±ä¸€ç‚¹çš„é¢œè‰²
            }
        });
        select.addEventListener('blur', updatePlaceholderDisplay);
        
        // åˆå§‹åŒ–æ˜¾ç¤º
        updatePlaceholderDisplay();
        
        // æ·»åŠ CSSç±»ç”¨äºæ ·å¼æ§åˆ¶
        select.classList.add('select-with-placeholder');
    });
}

// æ˜¾ç¤ºæ‰€æœ‰è¡¨å•ç»„ä»¶
function showAllFormGroups() {
    const allGroups = document.querySelectorAll('.search-form .form-group');
    allGroups.forEach(group => {
        if (group) {
            group.style.display = '';
        }
    });
}

// éšè—è¡¨å•ç»„ä»¶
function hideFormGroup(group) {
    if (group) {
        group.style.display = 'none';
    }
}

// æ›´æ–°selecté€‰é¡¹
function updateSelectOptions(select, options) {
    if (!select) return;
    
    // ä¿å­˜placeholderé€‰é¡¹
    const placeholderOption = select.querySelector('option[value=""]');
    
    // æ¸…ç©ºæ‰€æœ‰é€‰é¡¹
    select.innerHTML = '';
    
    // é‡æ–°æ·»åŠ placeholder
    if (placeholderOption) {
        select.appendChild(placeholderOption);
    }
    
    // æ·»åŠ æ–°é€‰é¡¹
    options.forEach(option => {
        const optionElement = document.createElement('option');
        optionElement.value = option.value;
        optionElement.textContent = option.text;
        select.appendChild(optionElement);
    });
}

// æ¢å¤æ‰€æœ‰selecté€‰é¡¹
function restoreAllSelectOptions() {
    // æ¢å¤å…³åŠ¡è¯„ä¼°çŠ¶æ€é€‰é¡¹
    const customsStatusSelect = document.getElementById('customs-status');
    if (customsStatusSelect) {
        updateSelectOptions(customsStatusSelect, [
            {value: 'pending-submit', text: 'å¾…æäº¤'},
            {value: 'pending-confirm', text: 'å¾…ç¡®è®¤'},
            {value: 'confirmed', text: 'å·²ç¡®è®¤'}
        ]);
    }
    
    // æ¢å¤å¼ºåˆ¶æ€§è®¤è¯è¯„ä¼°çŠ¶æ€é€‰é¡¹
    const certStatusSelect = document.getElementById('cert-status');
    if (certStatusSelect) {
        updateSelectOptions(certStatusSelect, [
            {value: 'pending-submit', text: 'å¾…æäº¤'},
            {value: 'submitted', text: 'å·²æäº¤'}
        ]);
    }
    
    // æ¢å¤æ˜¯å¦äº§ç”Ÿè®¢å•é€‰é¡¹
    const hasOrderSelect = document.getElementById('has-order');
    if (hasOrderSelect) {
        updateSelectOptions(hasOrderSelect, [
            {value: 'yes', text: 'æ˜¯'},
            {value: 'no', text: 'å¦'}
        ]);
    }
}

// è§¦å‘çŠ¶æ€TABè”åŠ¨é€»è¾‘
function triggerStatusTabLinkage(status) {
    // è·å–æ‰€æœ‰æŸ¥è¯¢è¡¨å•ç»„ä»¶ï¼ˆä½¿ç”¨æ›´å…¼å®¹çš„æ–¹æ³•ï¼‰
    const dataSourceGroup = document.getElementById('data-source');
    const customsStatusGroup = document.getElementById('customs-status')?.closest('.form-group');
    const serviceProviderGroup = document.getElementById('service-provider')?.closest('.form-group');
    const certStatusGroup = document.getElementById('cert-status')?.closest('.form-group');
    const productStatusGroup = document.getElementById('product-status');
    const hasOrderGroup = document.getElementById('has-order')?.closest('.form-group');
    const deadlineGroup = document.getElementById('deadline-start')?.closest('.form-group');
    
    // å…ˆæ˜¾ç¤ºæ‰€æœ‰ç»„ä»¶å¹¶æ¢å¤é€‰é¡¹
    showAllFormGroups();
    restoreAllSelectOptions();
    
    // æ ¹æ®çŠ¶æ€æ˜¾ç¤º/éšè—ç»„ä»¶å¹¶é™åˆ¶é€‰é¡¹
    switch(status) {
        case 'customs-pending':
            // å…³åŠ¡æœªè¯„ä¼°ï¼šåªæ˜¾ç¤ºå…³åŠ¡è¯„ä¼°çŠ¶æ€ï¼Œé™åˆ¶é€‰é¡¹ä¸ºå¾…æäº¤å’Œå¾…ç¡®è®¤
            hideFormGroup(certStatusGroup);
            hideFormGroup(hasOrderGroup);
            if (document.getElementById('customs-status')) {
                updateSelectOptions(document.getElementById('customs-status'), [
                    {value: 'pending-submit', text: 'å¾…æäº¤'},
                    {value: 'pending-confirm', text: 'å¾…ç¡®è®¤'}
                ]);
            }
            break;
        case 'cert-pending':
            // è®¤è¯æœªè¯„ä¼°ï¼šåªæ˜¾ç¤ºå¼ºåˆ¶æ€§è®¤è¯è¯„ä¼°çŠ¶æ€ï¼Œé™åˆ¶é€‰é¡¹ä¸ºå¾…æäº¤
            hideFormGroup(customsStatusGroup);
            hideFormGroup(serviceProviderGroup);
            hideFormGroup(hasOrderGroup);
            if (document.getElementById('cert-status')) {
                updateSelectOptions(document.getElementById('cert-status'), [
                    {value: 'pending-submit', text: 'å¾…æäº¤'}
                ]);
            }
            break;
        case 'element-pending':
            // è¦ç´ æœªç¡®è®¤ï¼šåªæ˜¾ç¤ºæ˜¯å¦äº§ç”Ÿè®¢å•ï¼Œé™åˆ¶é€‰é¡¹ä¸ºæ˜¯
            hideFormGroup(customsStatusGroup);
            hideFormGroup(certStatusGroup);
            hideFormGroup(serviceProviderGroup);
            hideFormGroup(deadlineGroup);
            if (document.getElementById('has-order')) {
                updateSelectOptions(document.getElementById('has-order'), [
                    {value: 'yes', text: 'æ˜¯'}
                ]);
            }
            break;
        default:
            // å…¨éƒ¨ï¼šæ˜¾ç¤ºæ‰€æœ‰ç»„ä»¶å’Œé€‰é¡¹
            break;
    }
}

// é™æ€æ¨¡æ‹Ÿæ•°æ® - ä½¿ç”¨data-simplified.jsç”Ÿæˆ
// æ³¨æ„ï¼šdata-simplified.jsä¼šåœ¨windowå¯¹è±¡ä¸Šå¯¼å‡ºstaticMockDataå’ŒtableColumns
const staticMockData = window.staticMockData || {
    china: [],
    thailand: [],
    vietnam: [],
    malaysia: [],
    indonesia: [],
    hungary: [],
    brazil: []
};
// æ¨¡æ‹Ÿæ•°æ® - ä¸åŒå›½å®¶çš„è¡¨å¤´é…ç½®
const countryTableHeaders = window.tableColumns || {};

function initSelectPlaceholders() {
    const selects = document.querySelectorAll('select[data-placeholder]');
    
    selects.forEach(select => {
        const placeholder = select.getAttribute('data-placeholder');
        
        // ç¡®ä¿selectæ²¡æœ‰é€‰ä¸­ä»»ä½•å€¼
        select.value = '';
        
        // è®¾ç½®placeholderæ ·å¼å’Œæ–‡æœ¬æ˜¾ç¤º
        function updatePlaceholderDisplay() {
            if (select.value === '') {
                // æ˜¾ç¤ºplaceholderæ ·å¼
                select.style.color = '#999';
                select.setAttribute('data-showing-placeholder', 'true');
            } else {
                // æ˜¾ç¤ºæ­£å¸¸é€‰ä¸­å€¼æ ·å¼
                select.style.color = '#333';
                select.removeAttribute('data-showing-placeholder');
            }
        }
        
        // ç›‘å¬å˜åŒ–äº‹ä»¶
        select.addEventListener('change', updatePlaceholderDisplay);
        select.addEventListener('focus', function() {
            if (this.value === '') {
                this.style.color = '#666'; // ç„¦ç‚¹æ—¶ç¨å¾®æ·±ä¸€ç‚¹çš„é¢œè‰²
            }
        });
        select.addEventListener('blur', updatePlaceholderDisplay);
        
        // åˆå§‹åŒ–æ˜¾ç¤º
        updatePlaceholderDisplay();
        
        // æ·»åŠ CSSç±»ç”¨äºæ ·å¼æ§åˆ¶
        select.classList.add('select-with-placeholder');
    });
}

// æ˜¾ç¤ºæ‰€æœ‰è¡¨å•ç»„ä»¶
function showAllFormGroups() {
    const allGroups = document.querySelectorAll('.search-form .form-group');
    allGroups.forEach(group => {
        if (group) {
            group.style.display = '';
        }
    });
}

// éšè—è¡¨å•ç»„ä»¶
function hideFormGroup(group) {
    if (group) {
        group.style.display = 'none';
    }
}

// æ›´æ–°selecté€‰é¡¹
function updateSelectOptions(select, options) {
    if (!select) return;
    
    // ä¿å­˜placeholderé€‰é¡¹
    const placeholderOption = select.querySelector('option[value=""]');
    
    // æ¸…ç©ºæ‰€æœ‰é€‰é¡¹
    select.innerHTML = '';
    
    // é‡æ–°æ·»åŠ placeholder
    if (placeholderOption) {
        select.appendChild(placeholderOption);
    }
    
    // æ·»åŠ æ–°é€‰é¡¹
    options.forEach(option => {
        const optionElement = document.createElement('option');
        optionElement.value = option.value;
        optionElement.textContent = option.text;
        select.appendChild(optionElement);
    });
}

// æ¢å¤æ‰€æœ‰selecté€‰é¡¹
function restoreAllSelectOptions() {
    // æ¢å¤å…³åŠ¡è¯„ä¼°çŠ¶æ€é€‰é¡¹
    const customsStatusSelect = document.getElementById('customs-status');
    if (customsStatusSelect) {
        updateSelectOptions(customsStatusSelect, [
            {value: 'pending-submit', text: 'å¾…æäº¤'},
            {value: 'pending-confirm', text: 'å¾…ç¡®è®¤'},
            {value: 'confirmed', text: 'å·²ç¡®è®¤'}
        ]);
    }
    
    // æ¢å¤å¼ºåˆ¶æ€§è®¤è¯è¯„ä¼°çŠ¶æ€é€‰é¡¹
    const certStatusSelect = document.getElementById('cert-status');
    if (certStatusSelect) {
        updateSelectOptions(certStatusSelect, [
            {value: 'pending-submit', text: 'å¾…æäº¤'},
            {value: 'submitted', text: 'å·²æäº¤'}
        ]);
    }
    
    // æ¢å¤æ˜¯å¦äº§ç”Ÿè®¢å•é€‰é¡¹
    const hasOrderSelect = document.getElementById('has-order');
    if (hasOrderSelect) {
        updateSelectOptions(hasOrderSelect, [
            {value: 'yes', text: 'æ˜¯'},
            {value: 'no', text: 'å¦'}
        ]);
    }
}

// è§¦å‘çŠ¶æ€TABè”åŠ¨é€»è¾‘
function triggerStatusTabLinkage(status) {
    // è·å–æ‰€æœ‰æŸ¥è¯¢è¡¨å•ç»„ä»¶ï¼ˆä½¿ç”¨æ›´å…¼å®¹çš„æ–¹æ³•ï¼‰
    const dataSourceGroup = document.getElementById('data-source');
    const customsStatusGroup = document.getElementById('customs-status')?.closest('.form-group');
    const serviceProviderGroup = document.getElementById('service-provider')?.closest('.form-group');
    const certStatusGroup = document.getElementById('cert-status')?.closest('.form-group');
    const productStatusGroup = document.getElementById('product-status');
    const hasOrderGroup = document.getElementById('has-order')?.closest('.form-group');
    const deadlineGroup = document.getElementById('deadline-start')?.closest('.form-group');
    
    // å…ˆæ˜¾ç¤ºæ‰€æœ‰ç»„ä»¶å¹¶æ¢å¤é€‰é¡¹
    showAllFormGroups();
    restoreAllSelectOptions();
    
    // æ ¹æ®çŠ¶æ€æ˜¾ç¤º/éšè—ç»„ä»¶å¹¶é™åˆ¶é€‰é¡¹
    switch(status) {
        case 'customs-pending':
            // å…³åŠ¡æœªè¯„ä¼°ï¼šåªæ˜¾ç¤ºå…³åŠ¡è¯„ä¼°çŠ¶æ€ï¼Œé™åˆ¶é€‰é¡¹ä¸ºå¾…æäº¤å’Œå¾…ç¡®è®¤
            hideFormGroup(certStatusGroup);
            hideFormGroup(hasOrderGroup);
            if (document.getElementById('customs-status')) {
                updateSelectOptions(document.getElementById('customs-status'), [
                    {value: 'pending-submit', text: 'å¾…æäº¤'},
                    {value: 'pending-confirm', text: 'å¾…ç¡®è®¤'}
                ]);
            }
            break;
        case 'cert-pending':
            // è®¤è¯æœªè¯„ä¼°ï¼šåªæ˜¾ç¤ºå¼ºåˆ¶æ€§è®¤è¯è¯„ä¼°çŠ¶æ€ï¼Œé™åˆ¶é€‰é¡¹ä¸ºå¾…æäº¤
            hideFormGroup(customsStatusGroup);
            hideFormGroup(serviceProviderGroup);
            hideFormGroup(hasOrderGroup);
            if (document.getElementById('cert-status')) {
                updateSelectOptions(document.getElementById('cert-status'), [
                    {value: 'pending-submit', text: 'å¾…æäº¤'}
                ]);
            }
            break;
        case 'element-pending':
            // è¦ç´ æœªç¡®è®¤ï¼šåªæ˜¾ç¤ºæ˜¯å¦äº§ç”Ÿè®¢å•ï¼Œé™åˆ¶é€‰é¡¹ä¸ºæ˜¯
            hideFormGroup(customsStatusGroup);
            hideFormGroup(certStatusGroup);
            hideFormGroup(serviceProviderGroup);
            hideFormGroup(deadlineGroup);
            if (document.getElementById('has-order')) {
                updateSelectOptions(document.getElementById('has-order'), [
                    {value: 'yes', text: 'æ˜¯'}
                ]);
            }
            break;
        default:
            // å…¨éƒ¨ï¼šæ˜¾ç¤ºæ‰€æœ‰ç»„ä»¶å’Œé€‰é¡¹
            break;
    }
}

// é™æ€æ¨¡æ‹Ÿæ•°æ® - ä½¿ç”¨data-simplified.jsç”Ÿæˆ
// æ³¨æ„ï¼šdata-simplified.jsä¼šåœ¨windowå¯¹è±¡ä¸Šå¯¼å‡ºstaticMockDataå’ŒtableColumns
const staticMockData = window.staticMockData || {
    china: [],
    thailand: [],
    vietnam: [],
    malaysia: [],
    indonesia: [],
    hungary: [],
    brazil: []
};

// æ¨¡æ‹Ÿæ•°æ® - ä¸åŒå›½å®¶çš„è¡¨å¤´é…ç½®
const countryTableHeaders = {
    china: [
        { key: 'checkbox', title: '', fixed: 'left', width: 50, checkbox: true },
        { key: 'domesticSku', title: 'å›½å†…SKU', fixed: 'left', width: 120 },
        { key: 'internationalSku', title: 'å›½é™…SKU', width: 120 },
        { key: 'productName', title: 'å•†å“ä¸­æ–‡åç§°', width: 200 },
        { key: 'hscode', title: 'HS Code', width: 120 },
        { key: 'exportTaxRate', title: 'å‡ºå£é€€ç¨ç‡%', width: 100, numeric: true },
        { key: 'exportTariffRate', title: 'å‡ºå£å…³ç¨ç¨ç‡%', width: 120, numeric: true },
        { key: 'isControlled', title: 'æ˜¯å¦ç®¡åˆ¶', width: 80 },
        { key: 'controlInfo', title: 'ç®¡åˆ¶ä¿¡æ¯', width: 150 },
        { key: 'declarationElements', title: 'ç”³æŠ¥è¦ç´ ', width: 200 },
        { key: 'declarationNameCn', title: 'ç”³æŠ¥å“ä¸­æ–‡å', width: 150 },
        { key: 'declarationNameEn', title: 'ç”³æŠ¥å“è‹±æ–‡å', width: 150 },
        { key: 'serviceProvider', title: 'è¯„ä¼°æœåŠ¡å•†', width: 100 },
        { key: 'dataSource', title: 'æ•°æ®æ¥æº', width: 100 },
        { key: 'salesErp', title: 'é‡‡é”€ERP', width: 100 },
        { key: 'deadline', title: 'è¯„ä¼°æˆªæ­¢æ—¶é—´', width: 120 },
        { key: 'customsStatus', title: 'å…³åŠ¡è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'certStatus', title: 'å¼ºåˆ¶æ€§è®¤è¯çŠ¶æ€', width: 140 },
        { key: 'productStatus', title: 'å•†å“è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'hasOrder', title: 'æ˜¯å¦äº§ç”Ÿè®¢å•', width: 100 },
        { key: 'elementStatus', title: 'è¦ç´ çŠ¶æ€', width: 100 },
        { key: 'creator', title: 'åˆ›å»ºäºº', width: 100 },
        { key: 'salesNote', title: 'é‡‡é”€å¤‡æ³¨', width: 150 },
        { key: 'createTime', title: 'åˆ›å»ºæ—¶é—´', width: 120 },
        { key: 'updater', title: 'æ›´æ–°äºº', width: 100 },
        { key: 'updateTime', title: 'æ›´æ–°æ—¶é—´', width: 120 },
        { key: 'actions', title: 'æ“ä½œ', fixed: 'right', width: 80 }
    ],
    thailand: [
        { key: 'checkbox', title: '', fixed: 'left', width: 50, checkbox: true },
        { key: 'domesticSku', title: 'å›½å†…SKU', fixed: 'left', width: 120 },
        { key: 'internationalSku', title: 'å›½é™…SKU', width: 120 },
        { key: 'productName', title: 'å•†å“ä¸­æ–‡åç§°', width: 200 },
        { key: 'hscode', title: 'æ³°å›½HSCODE', width: 120 },
        { key: 'mfnRate', title: 'æœ€æƒ å›½å…³ç¨MFN', width: 120, numeric: true },
        { key: 'formE', title: 'Form E%', width: 100, numeric: true },
        { key: 'vat', title: 'å¢å€¼ç¨VAT%', width: 100, numeric: true },
        { key: 'exciseTax', title: 'æ¶ˆè´¹ç¨ç‡excise tax%', width: 140, numeric: true },
        { key: 'localTax', title: 'æœ¬åœ°ç¨Local Tax', width: 120, numeric: true },
        { key: 'antiDumping', title: 'åå€¾é”€ç¨ç‡', width: 120, numeric: true },
        { key: 'isControlled', title: 'æ˜¯å¦ç®¡åˆ¶', width: 80 },
        { key: 'controlInfo', title: 'ç®¡åˆ¶ä¿¡æ¯', width: 150 },
        { key: 'serviceProvider', title: 'è¯„ä¼°æœåŠ¡å•†', width: 100 },
        { key: 'dataSource', title: 'æ•°æ®æ¥æº', width: 100 },
        { key: 'salesErp', title: 'é‡‡é”€ERP', width: 100 },
        { key: 'deadline', title: 'è¯„ä¼°æˆªæ­¢æ—¶é—´', width: 120 },
        { key: 'customsStatus', title: 'å…³åŠ¡è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'certStatus', title: 'å¼ºåˆ¶æ€§è®¤è¯çŠ¶æ€', width: 140 },
        { key: 'productStatus', title: 'å•†å“è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'hasOrder', title: 'æ˜¯å¦äº§ç”Ÿè®¢å•', width: 100 },
        { key: 'elementStatus', title: 'è¦ç´ çŠ¶æ€', width: 100 },
        { key: 'creator', title: 'åˆ›å»ºäºº', width: 100 },
        { key: 'salesNote', title: 'é‡‡é”€å¤‡æ³¨', width: 150 },
        { key: 'createTime', title: 'åˆ›å»ºæ—¶é—´', width: 120 },
        { key: 'updater', title: 'æ›´æ–°äºº', width: 100 },
        { key: 'updateTime', title: 'æ›´æ–°æ—¶é—´', width: 120 },
        { key: 'actions', title: 'æ“ä½œ', fixed: 'right', width: 80 }
    ],
    vietnam: [
        { key: 'checkbox', title: '', fixed: 'left', width: 50, checkbox: true },
        { key: 'domesticSku', title: 'å›½å†…SKU', fixed: 'left', width: 120 },
        { key: 'internationalSku', title: 'å›½é™…SKU', width: 120 },
        { key: 'productName', title: 'å•†å“ä¸­æ–‡åç§°', width: 200 },
        { key: 'hscode', title: 'è¶Šå—HSCODE', width: 120 },
        { key: 'mfnRate', title: 'æœ€æƒ å›½å…³ç¨MFN', width: 120, numeric: true },
        { key: 'formE', title: 'Form E%', width: 100, numeric: true },
        { key: 'vat', title: 'å¢å€¼ç¨VAT%', width: 100, numeric: true },
        { key: 'antiDumping', title: 'åå€¾é”€ç¨ç‡', width: 120, numeric: true },
        { key: 'isControlled', title: 'æ˜¯å¦ç®¡åˆ¶', width: 80 },
        { key: 'controlInfo', title: 'ç®¡åˆ¶ä¿¡æ¯', width: 150 },
        { key: 'serviceProvider', title: 'è¯„ä¼°æœåŠ¡å•†', width: 100 },
        { key: 'dataSource', title: 'æ•°æ®æ¥æº', width: 100 },
        { key: 'salesErp', title: 'é‡‡é”€ERP', width: 100 },
        { key: 'deadline', title: 'è¯„ä¼°æˆªæ­¢æ—¶é—´', width: 120 },
        { key: 'customsStatus', title: 'å…³åŠ¡è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'certStatus', title: 'å¼ºåˆ¶æ€§è®¤è¯çŠ¶æ€', width: 140 },
        { key: 'productStatus', title: 'å•†å“è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'hasOrder', title: 'æ˜¯å¦äº§ç”Ÿè®¢å•', width: 100 },
        { key: 'elementStatus', title: 'è¦ç´ çŠ¶æ€', width: 100 },
        { key: 'creator', title: 'åˆ›å»ºäºº', width: 100 },
        { key: 'salesNote', title: 'é‡‡é”€å¤‡æ³¨', width: 150 },
        { key: 'createTime', title: 'åˆ›å»ºæ—¶é—´', width: 120 },
        { key: 'updater', title: 'æ›´æ–°äºº', width: 100 },
        { key: 'updateTime', title: 'æ›´æ–°æ—¶é—´', width: 120 },
        { key: 'actions', title: 'æ“ä½œ', fixed: 'right', width: 80 }
    ],
    malaysia: [
        { key: 'checkbox', title: '', fixed: 'left', width: 50, checkbox: true },
        { key: 'domesticSku', title: 'å›½å†…SKU', fixed: 'left', width: 120 },
        { key: 'internationalSku', title: 'å›½é™…SKU', width: 120 },
        { key: 'productName', title: 'å•†å“ä¸­æ–‡åç§°', width: 200 },
        { key: 'hscode', title: 'é©¬æ¥HSCODE', width: 120 },
        { key: 'mfnRate', title: 'æœ€æƒ å›½å…³ç¨MFN', width: 120, numeric: true },
        { key: 'formE', title: 'Form E%', width: 100, numeric: true },
        { key: 'sst', title: 'é”€å”®ä¸æœåŠ¡ç¨SST%', width: 120, numeric: true },
        { key: 'antiDumping', title: 'åå€¾é”€ç¨ç‡', width: 120, numeric: true },
        { key: 'isControlled', title: 'æ˜¯å¦ç®¡åˆ¶', width: 80 },
        { key: 'controlInfo', title: 'ç®¡åˆ¶ä¿¡æ¯', width: 150 },
        { key: 'serviceProvider', title: 'è¯„ä¼°æœåŠ¡å•†', width: 100 },
        { key: 'dataSource', title: 'æ•°æ®æ¥æº', width: 100 },
        { key: 'salesErp', title: 'é‡‡é”€ERP', width: 100 },
        { key: 'deadline', title: 'è¯„ä¼°æˆªæ­¢æ—¶é—´', width: 120 },
        { key: 'customsStatus', title: 'å…³åŠ¡è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'certStatus', title: 'å¼ºåˆ¶æ€§è®¤è¯çŠ¶æ€', width: 140 },
        { key: 'productStatus', title: 'å•†å“è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'hasOrder', title: 'æ˜¯å¦äº§ç”Ÿè®¢å•', width: 100 },
        { key: 'elementStatus', title: 'è¦ç´ çŠ¶æ€', width: 100 },
        { key: 'creator', title: 'åˆ›å»ºäºº', width: 100 },
        { key: 'salesNote', title: 'é‡‡é”€å¤‡æ³¨', width: 150 },
        { key: 'createTime', title: 'åˆ›å»ºæ—¶é—´', width: 120 },
        { key: 'updater', title: 'æ›´æ–°äºº', width: 100 },
        { key: 'updateTime', title: 'æ›´æ–°æ—¶é—´', width: 120 },
        { key: 'actions', title: 'æ“ä½œ', fixed: 'right', width: 80 }
    ],
    indonesia: [
        { key: 'checkbox', title: '', fixed: 'left', width: 50, checkbox: true },
        { key: 'domesticSku', title: 'å›½å†…SKU', fixed: 'left', width: 120 },
        { key: 'internationalSku', title: 'å›½é™…SKU', width: 120 },
        { key: 'productName', title: 'å•†å“ä¸­æ–‡åç§°', width: 200 },
        { key: 'hscode', title: 'å°å°¼HSCODE', width: 120 },
        { key: 'formE', title: 'Form E%', width: 100, numeric: true },
        { key: 'ppn', title: 'å¢å€¼ç¨PPN%', width: 100, numeric: true },
        { key: 'pph', title: 'æ‰€å¾—ç¨PPH%', width: 100, numeric: true },
        { key: 'ppnbm', title: 'å¥¢ä¾ˆå“ç¨PPNBM%', width: 120, numeric: true },
        { key: 'bmt', title: 'è¿›å£ç¨BMT%', width: 120, numeric: true },
        { key: 'isControlled', title: 'æ˜¯å¦ç®¡åˆ¶', width: 80 },
        { key: 'controlInfo', title: 'ç®¡åˆ¶ä¿¡æ¯', width: 150 },
        { key: 'serviceProvider', title: 'è¯„ä¼°æœåŠ¡å•†', width: 100 },
        { key: 'dataSource', title: 'æ•°æ®æ¥æº', width: 100 },
        { key: 'salesErp', title: 'é‡‡é”€ERP', width: 100 },
        { key: 'deadline', title: 'è¯„ä¼°æˆªæ­¢æ—¶é—´', width: 120 },
        { key: 'customsStatus', title: 'å…³åŠ¡è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'certStatus', title: 'å¼ºåˆ¶æ€§è®¤è¯çŠ¶æ€', width: 140 },
        { key: 'productStatus', title: 'å•†å“è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'hasOrder', title: 'æ˜¯å¦äº§ç”Ÿè®¢å•', width: 100 },
        { key: 'elementStatus', title: 'è¦ç´ çŠ¶æ€', width: 100 },
        { key: 'creator', title: 'åˆ›å»ºäºº', width: 100 },
        { key: 'salesNote', title: 'é‡‡é”€å¤‡æ³¨', width: 150 },
        { key: 'createTime', title: 'åˆ›å»ºæ—¶é—´', width: 120 },
        { key: 'updater', title: 'æ›´æ–°äºº', width: 100 },
        { key: 'updateTime', title: 'æ›´æ–°æ—¶é—´', width: 120 },
        { key: 'actions', title: 'æ“ä½œ', fixed: 'right', width: 80 }
    ],
    hungary: [
        { key: 'checkbox', title: '', fixed: 'left', width: 50, checkbox: true },
        { key: 'domesticSku', title: 'å›½å†…SKU', fixed: 'left', width: 120 },
        { key: 'internationalSku', title: 'å›½é™…SKU', width: 120 },
        { key: 'productName', title: 'å•†å“ä¸­æ–‡åç§°', width: 200 },
        { key: 'hscode', title: 'åŒˆç‰™åˆ©HSCODE', width: 120 },
        { key: 'importDuty', title: 'è¿›å£å…³ç¨Import Duty%', width: 140, numeric: true },
        { key: 'antiDumping', title: 'åå€¾é”€ç¨ç‡', width: 120, numeric: true },
        { key: 'countervailing', title: 'åè¡¥è´´ç¨ç‡', width: 120, numeric: true },
        { key: 'vat', title: 'å¢å€¼ç¨VAT%', width: 100, numeric: true },
        { key: 'isControlled', title: 'æ˜¯å¦ç®¡åˆ¶', width: 80 },
        { key: 'controlInfo', title: 'ç®¡åˆ¶ä¿¡æ¯', width: 150 },
        { key: 'serviceProvider', title: 'è¯„ä¼°æœåŠ¡å•†', width: 100 },
        { key: 'dataSource', title: 'æ•°æ®æ¥æº', width: 100 },
        { key: 'salesErp', title: 'é‡‡é”€ERP', width: 100 },
        { key: 'deadline', title: 'è¯„ä¼°æˆªæ­¢æ—¶é—´', width: 120 },
        { key: 'customsStatus', title: 'å…³åŠ¡è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'certStatus', title: 'å¼ºåˆ¶æ€§è®¤è¯çŠ¶æ€', width: 140 },
        { key: 'productStatus', title: 'å•†å“è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'hasOrder', title: 'æ˜¯å¦äº§ç”Ÿè®¢å•', width: 100 },
        { key: 'elementStatus', title: 'è¦ç´ çŠ¶æ€', width: 100 },
        { key: 'creator', title: 'åˆ›å»ºäºº', width: 100 },
        { key: 'salesNote', title: 'é‡‡é”€å¤‡æ³¨', width: 150 },
        { key: 'createTime', title: 'åˆ›å»ºæ—¶é—´', width: 120 },
        { key: 'updater', title: 'æ›´æ–°äºº', width: 100 },
        { key: 'updateTime', title: 'æ›´æ–°æ—¶é—´', width: 120 },
        { key: 'actions', title: 'æ“ä½œ', fixed: 'right', width: 80 }
    ],
    brazil: [
        { key: 'checkbox', title: '', fixed: 'left', width: 50, checkbox: true },
        { key: 'domesticSku', title: 'å›½å†…SKU', fixed: 'left', width: 120 },
        { key: 'internationalSku', title: 'å›½é™…SKU', width: 120 },
        { key: 'productName', title: 'å•†å“ä¸­æ–‡åç§°', width: 200 },
        { key: 'hscode', title: 'å·´è¥¿HSCODE', width: 120 },
        { key: 'ii', title: 'è¿›å£ç¨II%', width: 100, numeric: true },
        { key: 'ipi', title: 'å·¥ä¸šäº§å“ç¨IPI%', width: 120, numeric: true },
        { key: 'pis', title: 'ç¤¾ä¼šä¸€ä½“åŒ–ç¨PIS%', width: 140, numeric: true },
        { key: 'confins', title: 'ç¤¾ä¼šä¿éšœèèµ„ç¨COFINS%', width: 160, numeric: true },
        { key: 'icms', title: 'å•†å“æµé€šç¨ICMS%', width: 120, numeric: true },
        { key: 'antiDumping', title: 'åå€¾é”€ç¨ç‡', width: 120, numeric: true },
        { key: 'isControlled', title: 'æ˜¯å¦ç®¡åˆ¶', width: 80 },
        { key: 'controlInfo', title: 'ç®¡åˆ¶ä¿¡æ¯', width: 150 },
        { key: 'serviceProvider', title: 'è¯„ä¼°æœåŠ¡å•†', width: 100 },
        { key: 'dataSource', title: 'æ•°æ®æ¥æº', width: 100 },
        { key: 'salesErp', title: 'é‡‡é”€ERP', width: 100 },
        { key: 'deadline', title: 'è¯„ä¼°æˆªæ­¢æ—¶é—´', width: 120 },
        { key: 'customsStatus', title: 'å…³åŠ¡è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'certStatus', title: 'å¼ºåˆ¶æ€§è®¤è¯çŠ¶æ€', width: 140 },
        { key: 'productStatus', title: 'å•†å“è¯„ä¼°çŠ¶æ€', width: 120 },
        { key: 'hasOrder', title: 'æ˜¯å¦äº§ç”Ÿè®¢å•', width: 100 },
        { key: 'elementStatus', title: 'è¦ç´ çŠ¶æ€', width: 100 },
        { key: 'creator', title: 'åˆ›å»ºäºº', width: 100 },
        { key: 'salesNote', title: 'é‡‡é”€å¤‡æ³¨', width: 150 },
        { key: 'createTime', title: 'åˆ›å»ºæ—¶é—´', width: 120 },
        { key: 'updater', title: 'æ›´æ–°äºº', width: 100 },
        { key: 'updateTime', title: 'æ›´æ–°æ—¶é—´', width: 120 },
        { key: 'actions', title: 'æ“ä½œ', fixed: 'right', width: 80 }
    ]
};

// åˆå§‹åŒ–é¡µé¢
function initializePage() {
    console.log('å…³åŠ¡å•†å“ç®¡ç†é¡µé¢åˆå§‹åŒ–ä¸­...');
    
    // åˆå§‹åŒ–select placeholderåŠŸèƒ½
    initSelectPlaceholders();
    
    // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
    bindEventListeners();
    
    // æ›´æ–°çŠ¶æ€TABçš„æ•°å­—å¾½æ ‡
    updateStatusBadges();
    
    // è®¾ç½®é»˜è®¤çš„å›½å®¶å’ŒçŠ¶æ€
    setActiveCountryTab(currentCountry);
    setActiveStatusTab(currentStatus);
    
    // é»˜è®¤åŠ è½½ä¸­å›½æ•°æ®
    switchCountryTab('china');
    
    console.log('å…³åŠ¡å•†å“ç®¡ç†é¡µé¢åˆå§‹åŒ–å®Œæˆ');
}

// æ›´æ–°çŠ¶æ€å¾½æ ‡
function updateStatusBadges() {
    // è¿™é‡Œåº”è¯¥ä»APIè·å–å®é™…çš„ç»Ÿè®¡æ•°æ®
    // ç›®å‰ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
    const badges = {
        'all': 1234,
        'pending': 156,
        'processing': 89,
        'completed': 989
    };
    
    // æ›´æ–°å„ä¸ªçŠ¶æ€TABçš„å¾½æ ‡æ•°å­—
    Object.keys(badges).forEach(status => {
        const badge = document.querySelector(`[data-status="${status}"] .badge`);
        if (badge) {
            badge.textContent = badges[status];
        }
    });
}

// ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
function bindEventListeners() {
    // çŠ¶æ€TABç‚¹å‡»äº‹ä»¶
    const statusTabs = document.querySelectorAll('.status-tab-btn');
    console.log('Found status tabs:', statusTabs.length);
    statusTabs.forEach(tab => {
        console.log('Binding event to tab:', tab.getAttribute('data-status'));
        tab.addEventListener('click', function() {
            console.log('Status tab clicked:', this.getAttribute('data-status'));
            const status = this.getAttribute('data-status');
            switchStatusTab(status);
        });
    });
    
    // å›½å®¶TABç‚¹å‡»äº‹ä»¶
    const countryTabs = document.querySelectorAll('.tab-btn');
    countryTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const country = this.getAttribute('data-country');
            switchCountryTab(country);
        });
    });
    
    // æŸ¥è¯¢è¡¨å•äº‹ä»¶
    bindSearchFormEvents();
    
    // åˆ†é¡µäº‹ä»¶
    bindPaginationEvents();
    
    // å±•å¼€/æ”¶èµ·æŒ‰é’®äº‹ä»¶
// ç»‘å®šå±•å¼€/æ”¶èµ·æŒ‰é’®äº‹ä»¶
function bindToggleEvents() {
    const toggleBtn = document.getElementById('search-toggle');
    if (toggleBtn) {
        toggleBtn.addEventListener('click', function() {
            const searchForm = document.querySelector('.search-form');
            const isCollapsed = searchForm.classList.contains('collapsed');
            
            if (isCollapsed) {
                searchForm.classList.remove('collapsed');
                toggleBtn.innerHTML = 'æ”¶èµ· â–²';
            } else {
                searchForm.classList.add('collapsed');
                toggleBtn.innerHTML = 'å±•å¼€ â–¼';
            }
        });
    }
}
    bindToggleEvents();
}

// æŸ¥è¯¢åŠŸèƒ½
function searchProducts() {
    // æ”¶é›†æŸ¥è¯¢å‚æ•°
    searchParams = {
        domesticSku: document.getElementById('domestic-sku')?.value || '',
        internationalSku: document.getElementById('international-sku')?.value || '',
        hscode: document.getElementById('hscode')?.value || '',
        productTitle: document.getElementById('product-title')?.value || '',
        dataSource: document.getElementById('data-source-select')?.value || '',
        customsStatus: document.getElementById('customs-status')?.value || '',
        serviceProvider: document.getElementById('service-provider')?.value || '',
        certStatus: document.getElementById('cert-status')?.value || '',
        productStatus: document.getElementById('product-status-select')?.value || '',
        hasOrder: document.getElementById('has-order')?.value || '',
        creatorErp: document.getElementById('creator-erp-input')?.value || '',
        createTimeStart: document.getElementById('create-time-start-input')?.value || '',
        createTimeEnd: document.getElementById('create-time-end-input')?.value || '',
        deadlineStart: document.getElementById('deadline-start')?.value || '',
        deadlineEnd: document.getElementById('deadline-end')?.value || '',
        updaterErp: document.getElementById('updater-erp')?.value || '',
        updateTimeStart: document.getElementById('update-time-start')?.value || '',
        updateTimeEnd: document.getElementById('update-time-end')?.value || ''
    };
    
    // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
    currentPage = 1;
    
    // åŠ è½½æ•°æ®
    loadTableData();
    
    console.log('æ‰§è¡ŒæŸ¥è¯¢ï¼Œå‚æ•°ï¼š', searchParams);
}
// é‡ç½®æŸ¥è¯¢
function resetSearch() {
    // æ¸…ç©ºæ‰€æœ‰è¡¨å•å­—æ®µ
    const form = document.querySelector('.search-form');
    if (form) {
        const inputs = form.querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
            if (input.type === 'checkbox' || input.type === 'radio') {
                input.checked = false;
            } else {
                input.value = '';
            }
        });
    }
    
    // æ¸…ç©ºæŸ¥è¯¢å‚æ•°
    searchParams = {};
    
    // é‡ç½®åˆ°ç¬¬ä¸€é¡µ
    currentPage = 1;
    
    // é‡æ–°åŠ è½½æ•°æ®
    loadTableData();
    
    console.log('é‡ç½®æŸ¥è¯¢æ¡ä»¶');
}
// ç»‘å®šæŸ¥è¯¢è¡¨å•äº‹ä»¶
function bindSearchFormEvents() {
    // æŸ¥è¯¢æŒ‰é’®
    const searchBtn = document.querySelector('.btn-primary');
    if (searchBtn) {
        searchBtn.addEventListener('click', searchProducts);
    }
    
    // é‡ç½®æŒ‰é’®
    const resetBtn = document.querySelector('.btn-secondary');
    if (resetBtn) {
        resetBtn.addEventListener('click', resetSearch);
    }
    
    // å›è½¦é”®æŸ¥è¯¢
    const searchInputs = document.querySelectorAll('input, select, textarea');
    searchInputs.forEach(input => {
        input.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchProducts();
            }
        });
    });
}

// åˆ†é¡µå‡½æ•°å®šä¹‰
function prevPage() {
    if (currentPage > 1) {
        currentPage--;
        loadTableData();
    }
}

function nextPage() {
    if (currentPage < totalPages) {
        currentPage++;
        loadTableData();
    }
}

function jumpToPage() {
    const pageInput = document.getElementById('page-input');
    if (pageInput) {
        const targetPage = parseInt(pageInput.value);
        if (targetPage >= 1 && targetPage <= totalPages && targetPage !== currentPage) {
            currentPage = targetPage;
            loadTableData();
        }
    }
}

// ç»‘å®šåˆ†é¡µäº‹ä»¶
function bindPaginationEvents() {
    // ä¸Šä¸€é¡µæŒ‰é’®
    const prevBtn = document.getElementById('prev-btn');
    if (prevBtn) {
        prevBtn.addEventListener('click', prevPage);
    }
    
    // ä¸‹ä¸€é¡µæŒ‰é’®
    const nextBtn = document.getElementById('next-btn');
    if (nextBtn) {
        nextBtn.addEventListener('click', nextPage);
    }
    
    // è·³è½¬æŒ‰é’®
    const jumpBtn = document.querySelector('.page-jump .btn-sm');
    if (jumpBtn) {
        jumpBtn.addEventListener('click', jumpToPage);
    }
    
    // é¡µç è¾“å…¥æ¡†å›è½¦äº‹ä»¶
    const pageInput = document.getElementById('page-input');
    if (pageInput) {
        pageInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                jumpToPage();
            }
        });
    }
}

// åˆ‡æ¢çŠ¶æ€TAB
function switchStatusTab(status) {
    console.log('switchStatusTab called with status:', status);
    currentStatus = status;
    setActiveStatusTab(status);
    
    // æ ¹æ®çŠ¶æ€è®¾ç½®æŸ¥è¯¢æ¡ä»¶
    setSearchParamsByStatus(status);
    
    // æ§åˆ¶è¦ç´ çŠ¶æ€ç»„ä»¶çš„æ˜¾ç¤º/éšè—
    toggleElementStatusComponent(status);
    
    // æ§åˆ¶è¡¨æ ¼åˆ—çš„æ˜¾ç¤º/éšè—
    toggleTableColumns(status);
    
    // è§¦å‘çŠ¶æ€TABè”åŠ¨é€»è¾‘
    triggerStatusTabLinkage(status);
    
    // å»¶è¿Ÿè°ƒç”¨ï¼Œç¡®ä¿loadTableDataå‡½æ•°å·²å®šä¹‰
    setTimeout(() => {
        if (typeof loadTableData === 'function') {
            loadTableData();
        }
    }, 0);
}

// è®¾ç½®æ´»è·ƒçŠ¶æ€TAB
function setActiveStatusTab(status) {
    const statusTabs = document.querySelectorAll('.status-tab-btn');
    statusTabs.forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('data-status') === status) {
            tab.classList.add('active');
        }
    });
}

// æ§åˆ¶è¦ç´ çŠ¶æ€ç»„ä»¶çš„æ˜¾ç¤º/éšè—
function toggleElementStatusComponent(status) {
    const elementStatusGroup = document.getElementById('element-status-group');
    if (elementStatusGroup) {
        // ä»…åœ¨"å…¨éƒ¨"å’Œ"è¦ç´ æœªç¡®è®¤"tabä¸­æ˜¾ç¤ºè¦ç´ çŠ¶æ€ç»„ä»¶
        if (status === 'all' || status === 'element-pending') {
            elementStatusGroup.style.display = 'block';
        } else {
            elementStatusGroup.style.display = 'none';
        }
    }
    
    // åœ¨"è¦ç´ æœªç¡®è®¤"çŠ¶æ€ä¸‹éšè—ç‰¹å®šçš„æŸ¥è¯¢æ¡ä»¶ç»„ä»¶
    const componentsToHide = [
        'data-source',      // æ•°æ®æ¥æºï¼ˆform-groupçš„IDï¼‰
        'product-status',   // å•†å“è¯„ä¼°çŠ¶æ€ï¼ˆform-groupçš„IDï¼‰
        'creator-erp',      // åˆ›å»ºäººERPï¼ˆform-groupçš„IDï¼‰
        'create-time-start' // åˆ›å»ºæ—¶é—´ï¼ˆform-groupçš„IDï¼ŒåŒ…å«å¼€å§‹å’Œç»“æŸæ—¶é—´ï¼‰
    ];
    
    if (status === 'element-pending') {
        // éšè—æŒ‡å®šç»„ä»¶ï¼ˆç›´æ¥é€šè¿‡form-groupçš„IDï¼‰
        componentsToHide.forEach(id => {
            const formGroup = document.getElementById(id);
            if (formGroup) {
                formGroup.style.display = 'none';
            }
        });
    } else {
        // æ˜¾ç¤ºæ‰€æœ‰ç»„ä»¶ï¼ˆç›´æ¥é€šè¿‡form-groupçš„IDï¼‰
        componentsToHide.forEach(id => {
            const formGroup = document.getElementById(id);
            if (formGroup) {
                formGroup.style.display = '';
            }
        });
    }
}

// æ§åˆ¶è¡¨æ ¼åˆ—çš„æ˜¾ç¤º/éšè—
function toggleTableColumns(status) {
    // éœ€è¦éšè—çš„åˆ—ï¼šæ•°æ®æ¥æºã€åˆ›å»ºäººã€åˆ›å»ºæ—¶é—´
    // æ ¹æ®è¡¨å¤´é…ç½®ï¼Œè¿™äº›åˆ—çš„ç´¢å¼•åˆ†åˆ«æ˜¯ï¼šdataSource(13), creator(21), createTime(23)
    const columnsToHide = ['dataSource', 'creator', 'createTime'];
    
    if (status === 'element-pending') {
        // è¦ç´ æœªç¡®è®¤çŠ¶æ€ä¸‹éšè—æŒ‡å®šåˆ—
        hideTableColumns(columnsToHide);
    } else {
        // å…¶ä»–çŠ¶æ€ä¸‹æ˜¾ç¤ºæ‰€æœ‰åˆ—
        showTableColumns(columnsToHide);
    }
}

// éšè—è¡¨æ ¼åˆ—
function hideTableColumns(columnKeys) {
    const headers = countryTableHeaders[currentCountry] || countryTableHeaders.china;
    
    columnKeys.forEach(key => {
        const columnIndex = headers.findIndex(header => header.key === key);
        if (columnIndex !== -1) {
            // éšè—è¡¨å¤´
            const headerCell = document.querySelector(`#table-header th:nth-child(${columnIndex + 1})`);
            if (headerCell) {
                headerCell.style.display = 'none';
            }
            
            // éšè—æ•°æ®è¡Œä¸­å¯¹åº”çš„åˆ—
            const dataCells = document.querySelectorAll(`#table-body td:nth-child(${columnIndex + 1})`);
            dataCells.forEach(cell => {
                cell.style.display = 'none';
            });
        }
    });
}

// æ˜¾ç¤ºè¡¨æ ¼åˆ—
function showTableColumns(columnKeys) {
    const headers = countryTableHeaders[currentCountry] || countryTableHeaders.china;
    
    columnKeys.forEach(key => {
        const columnIndex = headers.findIndex(header => header.key === key);
        if (columnIndex !== -1) {
            // æ˜¾ç¤ºè¡¨å¤´
            const headerCell = document.querySelector(`#table-header th:nth-child(${columnIndex + 1})`);
            if (headerCell) {
                headerCell.style.display = '';
            }
            
            // æ˜¾ç¤ºæ•°æ®è¡Œä¸­å¯¹åº”çš„åˆ—
            const dataCells = document.querySelectorAll(`#table-body td:nth-child(${columnIndex + 1})`);
            dataCells.forEach(cell => {
                cell.style.display = '';
            });
        }
    });
}

// æ ¹æ®çŠ¶æ€è®¾ç½®æŸ¥è¯¢æ¡ä»¶
function setSearchParamsByStatus(status) {
    const customsStatusSelect = document.getElementById('customs-status');
    const certStatusSelect = document.getElementById('cert-status');
    const hasOrderSelect = document.getElementById('has-order');
    
    // æ¸…ç©ºä¹‹å‰çš„æ¡ä»¶
    if (customsStatusSelect) customsStatusSelect.value = '';
    if (certStatusSelect) certStatusSelect.value = '';
    if (hasOrderSelect) hasOrderSelect.value = '';
    
    switch (status) {
        case 'customs-pending':
            // å…³åŠ¡æœªè¯„ä¼°ï¼šå…³åŠ¡è¯„ä¼°çŠ¶æ€ï¼šå¾…æäº¤ã€å¾…ç¡®è®¤
            if (customsStatusSelect) {
                customsStatusSelect.value = 'pending-submit';
            }
            break;
        case 'cert-pending':
            // è®¤è¯æœªè¯„ä¼°ï¼šè®¤è¯è¯„ä¼°çŠ¶æ€ï¼šå¾…æäº¤
            if (certStatusSelect) {
                certStatusSelect.value = 'pending-submit';
            }
            break;
        case 'element-pending':
            // è¦ç´ æœªç¡®è®¤ï¼šæ˜¯å¦äº§ç”Ÿè®¢å•ï¼šæ˜¯ ä¸” è®¢å•æŠ¥å…³è¦ç´ çŠ¶æ€ï¼šå¾…æäº¤ã€å¾…ç¡®è®¤
            if (hasOrderSelect) {
                hasOrderSelect.value = 'æ˜¯';
            }
            break;
        default:
// è§¦å‘çŠ¶æ€TABè”åŠ¨é€»è¾‘

// åˆ‡æ¢å›½å®¶TAB

// åˆå§‹åŒ–è¡¨æ ¼
function initializeTable() {
    updateTableHeader();
    loadTableData();
}

// æ›´æ–°è¡¨æ ¼è¡¨å¤´
function updateTableHeader() {
    const tableHeader = document.getElementById('table-header');
    const headers = countryTableHeaders[currentCountry] || countryTableHeaders.china;
    
    let headerHtml = '<tr>';
    headers.forEach(header => {
        let classes = [];
        if (header.fixed) {
            classes.push('fixed-column');
            if (header.checkbox) {
                classes.push('checkbox-column');
            } else if (header.fixed === 'left') {
                classes.push('sku-column');
            } else if (header.fixed === 'right') {
                classes.push('action-column');
            }
        }
        if (header.numeric) {
            classes.push('numeric');
        }
        
        // ç‰¹æ®Šå¤„ç†å¤é€‰æ¡†åˆ—
        if (header.checkbox) {
            headerHtml += `<th class="${classes.join(' ')}">
                <input type="checkbox" id="select-all" onchange="toggleSelectAll(this)">
            </th>`;
        } else {
            headerHtml += `<th class="${classes.join(' ')}">${header.title}</th>`;
        }
    });
    headerHtml += '</tr>';
    
    tableHeader.innerHTML = headerHtml;
}

// åŠ è½½è¡¨æ ¼æ•°æ®
function loadTableData() {
    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    showLoadingState();
    
    // æ¨¡æ‹ŸAPIè°ƒç”¨
    setTimeout(() => {
        // è¿™é‡Œåº”è¯¥æ˜¯å®é™…çš„APIè°ƒç”¨
        const mockData = generateMockData();
        renderTableData(mockData);
        updatePagination();
    }, 500);
}

// æ˜¾ç¤ºåŠ è½½çŠ¶æ€
function showLoadingState() {
    const tableBody = document.getElementById('table-body');
    const headers = countryTableHeaders[currentCountry] || countryTableHeaders.china;
    
    tableBody.innerHTML = `
        <tr class="loading-row">
            <td colspan="${headers.length}" class="loading-message">
                <div class="loading-content">
                    <div class="loading-spinner">â³</div>
                    <div class="loading-text">æ•°æ®åŠ è½½ä¸­...</div>
                </div>
            </td>
        </tr>
    `;
}

// æ ¹æ®æŸ¥è¯¢æ¡ä»¶è¿‡æ»¤æ•°æ®
function filterDataBySearchParams(data, params) {
    return data.filter(item => {
        // å›½å†…SKUè¿‡æ»¤
        if (params.domesticSku && params.domesticSku.trim()) {
            const skus = params.domesticSku.split('\n').map(s => s.trim()).filter(s => s);
            if (!skus.some(sku => item.domesticSku.includes(sku))) return false;
        }
        
        // å›½é™…SKUè¿‡æ»¤
        if (params.internationalSku && params.internationalSku.trim()) {
            const skus = params.internationalSku.split('\n').map(s => s.trim()).filter(s => s);
            if (!skus.some(sku => item.internationalSku.includes(sku))) return false;
        }
        
        // æµ·å…³ç¼–ç è¿‡æ»¤
        if (params.hscode && params.hscode.trim()) {
            const codes = params.hscode.split('\n').map(s => s.trim()).filter(s => s);
            if (!codes.some(code => item.hscode.includes(code))) return false;
        }
        
        // å•†å“æ ‡é¢˜è¿‡æ»¤
        if (params.productTitle && params.productTitle.trim()) {
            if (!item.productName.includes(params.productTitle.trim())) return false;
        }
        
        // æ•°æ®æ¥æºè¿‡æ»¤
        if (params.dataSource && params.dataSource !== item.dataSource) return false;
        
        // å…³åŠ¡è¯„ä¼°çŠ¶æ€è¿‡æ»¤
        if (params.customsStatus && params.customsStatus !== item.customsStatus) return false;
        
        // æœåŠ¡å•†è¿‡æ»¤
        if (params.serviceProvider && params.serviceProvider !== item.serviceProvider) return false;
        
        // è®¤è¯è¯„ä¼°çŠ¶æ€è¿‡æ»¤
        if (params.certStatus && params.certStatus !== item.certStatus) return false;
        
        // å•†å“è¯„ä¼°çŠ¶æ€è¿‡æ»¤
        if (params.productStatus && params.productStatus !== item.productStatus) return false;
        
        // æ˜¯å¦äº§ç”Ÿè®¢å•è¿‡æ»¤
        if (params.hasOrder && params.hasOrder !== item.hasOrder) return false;
        
        // åˆ›å»ºäººERPè¿‡æ»¤
        if (params.creatorErp && params.creatorErp.trim()) {
            if (!item.creator.includes(params.creatorErp.trim())) return false;
        }
        
        // åˆ›å»ºæ—¶é—´è¿‡æ»¤
        if (params.createTimeStart && item.createTime < params.createTimeStart) return false;
        if (params.createTimeEnd && item.createTime > params.createTimeEnd) return false;
        
        // è¯„ä¼°æˆªæ­¢æ—¶é—´è¿‡æ»¤
        if (params.deadlineStart && item.deadline && item.deadline < params.deadlineStart) return false;
        if (params.deadlineEnd && item.deadline && item.deadline > params.deadlineEnd) return false;
        
        // æ›´æ–°äººERPè¿‡æ»¤
        if (params.updaterErp && params.updaterErp.trim()) {
            if (!item.updater.includes(params.updaterErp.trim())) return false;
        }
        
        // æ›´æ–°æ—¶é—´è¿‡æ»¤
        if (params.updateTimeStart && item.updateTime < params.updateTimeStart) return false;
        if (params.updateTimeEnd && item.updateTime > params.updateTimeEnd) return false;
        
        return true;
    });
}

// æ ¹æ®çŠ¶æ€TABè¿‡æ»¤æ•°æ®
function filterDataByStatus(data, status) {
    switch (status) {
        case 'customs-pending':
            return data.filter(item => item.customsStatus === 'pending-submit' || item.customsStatus === 'pending-confirm');
        case 'cert-pending':
            return data.filter(item => item.certStatus === 'pending-submit');
        case 'element-pending':
            return data.filter(item => item.hasOrder === 'æ˜¯' && item.elementStatus === 'pending-submit');
        default:
            return data;
    }
}

// æ¸²æŸ“è¡¨æ ¼æ•°æ®


// è·å–çŠ¶æ€æ–‡æœ¬
function getStatusText(status) {
    const statusMap = {
        'pending-submit': 'å¾…æäº¤',
        'pending-confirm': 'å¾…ç¡®è®¤',
        'confirmed': 'å·²ç¡®è®¤',
        'submitted': 'å·²æäº¤',
        'active': 'å·²ç”Ÿæ•ˆ',
        'inactive': 'æœªç”Ÿæ•ˆ'
    };
    return statusMap[status] || status;
}

// æ›´æ–°çŠ¶æ€å¾½æ ‡
function updateStatusBadges() {
    // è¿™é‡Œåº”è¯¥ä»APIè·å–å®é™…çš„ç»Ÿè®¡æ•°æ®
    const badges = {
        'all': 1234,
        'customs-pending': 56,
        'cert-pending': 23,
        'element-pending': 12
    };
    
    Object.keys(badges).forEach(status => {
        const tab = document.querySelector(`[data-status="${status}"]`);
        if (tab) {
            const badge = tab.querySelector('.badge');
            if (badge) {
                badge.textContent = badges[status];
            }
        }
    });
}

// é‡ç½®æŸ¥è¯¢
// åˆ†é¡µåŠŸèƒ½
function updatePagination() {
    const pageInfo = document.getElementById('page-info');
    const totalRecordsSpan = document.getElementById('total-records');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const pageInput = document.getElementById('page-input');
    
    if (pageInfo) {
        pageInfo.textContent = `ç¬¬${currentPage}é¡µï¼Œå…±${totalPages}é¡µ`;
    }
    
    if (totalRecordsSpan) {
        totalRecordsSpan.textContent = totalRecords;
    }
    
    if (prevBtn) {
        prevBtn.disabled = currentPage <= 1;
    }
    
    if (nextBtn) {
        nextBtn.disabled = currentPage >= totalPages;
    }
    
    if (pageInput) {
        pageInput.value = currentPage;
        pageInput.max = totalPages;
    }
}

// æ“ä½œæŒ‰é’®åŠŸèƒ½

// æ“ä½œæŒ‰é’®åŠŸèƒ½
function exportData() {
    console.log('å¯¼å‡ºæ•°æ®');
    alert('å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­...');
}

function importProducts() {
    console.log('å¯¼å…¥å•†å“');
    alert('å¯¼å…¥å•†å“åŠŸèƒ½å¼€å‘ä¸­...');
}

function importCustomsAssessment() {
    console.log('å¯¼å…¥å…³åŠ¡è¯„ä¼°');
    alert('å¯¼å…¥å…³åŠ¡è¯„ä¼°åŠŸèƒ½å¼€å‘ä¸­...');
}

function customsAssessment() {
    console.log('å…³åŠ¡è¯„ä¼°');
    alert('å…³åŠ¡è¯„ä¼°åŠŸèƒ½å¼€å‘ä¸­...');
}

function assignServiceProvider() {
    console.log('åˆ†é…æœåŠ¡å•†');
    alert('åˆ†é…æœåŠ¡å•†åŠŸèƒ½å¼€å‘ä¸­...');
}

function customsConfirm() {
    console.log('å…³åŠ¡ç¡®è®¤');
    alert('å…³åŠ¡ç¡®è®¤åŠŸèƒ½å¼€å‘ä¸­...');
}

function certificationAssessment() {
    console.log('è®¤è¯è¯„ä¼°');
    alert('è®¤è¯è¯„ä¼°åŠŸèƒ½å¼€å‘ä¸­...');
}
// è·å–å½“å‰é€‰ä¸­çš„å›½å®¶
function getCurrentCountry() {
    return currentCountry || 'china';
}

// ç”Ÿæˆæ“ä½œæŒ‰é’®
function generateActionButtons(row) {
    const buttons = [];
    const country = getCurrentCountry();
    
    // æ ¹æ®çŠ¶æ€æ˜¾ç¤ºä¸åŒçš„æŒ‰é’®
    // å…³åŠ¡è¯„ä¼°çŠ¶æ€ä¸ºå¾…æäº¤æ—¶æ˜¾ç¤ºã€å…³åŠ¡è¯„ä¼°ã€‘æŒ‰é’®
    if (row.customsStatus === 'pending-submit') {
        buttons.push(`<button class="btn btn-sm btn-primary" onclick="performCustomsEvaluation(getCurrentRowData('${row.domesticSku}'))">å…³åŠ¡è¯„ä¼°</button>`);
    }
    
    // å…³åŠ¡è¯„ä¼°çŠ¶æ€ä¸ºå¾…ç¡®è®¤æ—¶æ˜¾ç¤ºã€å…³åŠ¡ç¡®è®¤ã€‘æŒ‰é’®
    if (row.customsStatus === 'pending-confirm') {
        buttons.push(`<button class="btn btn-sm btn-success" onclick="performCustomsConfirmation(getCurrentRowData('${row.domesticSku}'))">å…³åŠ¡ç¡®è®¤</button>`);
    }
    
    // è®¤è¯è¯„ä¼°çŠ¶æ€ä¸ºå¾…æäº¤æ—¶æ˜¾ç¤ºã€è®¤è¯è¯„ä¼°ã€‘æŒ‰é’®
    if (row.certStatus === 'pending-submit') {
        buttons.push(`<button class="btn btn-sm btn-info" onclick="performCertEvaluation(getCurrentRowData('${row.domesticSku}'))">è®¤è¯è¯„ä¼°</button>`);
    }
    
    // åˆ†é…æœåŠ¡å•†æŒ‰é’®ï¼ˆå½“æœåŠ¡å•†ä¸ºç©ºæ—¶æ˜¾ç¤ºï¼‰
    if (!row.serviceProvider || row.serviceProvider === '') {
        buttons.push(`<button class="btn btn-sm btn-warning" onclick="performAssignProvider('${row.domesticSku}')">åˆ†é…æœåŠ¡å•†</button>`);
    }
    
    // æŸ¥çœ‹è¯¦æƒ…æŒ‰é’®ï¼ˆå§‹ç»ˆæ˜¾ç¤ºï¼‰
    buttons.push(`<button class="btn btn-sm btn-outline-primary" onclick="viewProductDetail('${row.domesticSku}')">æŸ¥çœ‹</button>`);
    
    // åˆ é™¤æŒ‰é’®ï¼ˆå§‹ç»ˆæ˜¾ç¤ºï¼‰
    buttons.push(`<button class="btn btn-sm btn-outline-danger" onclick="deleteProduct('${row.domesticSku}')">åˆ é™¤</button>`);
    
    return buttons.join(' ');
}

// æ‰§è¡Œå…³åŠ¡è¯„ä¼°
function performCustomsAssessment(domesticSku) {
    console.log('æ‰§è¡Œå…³åŠ¡è¯„ä¼°:', domesticSku);
    
    // æ¨¡æ‹Ÿå…³åŠ¡è¯„ä¼°æäº¤
    const confirmed = confirm(`ç¡®å®šè¦å¯¹å•†å“ ${domesticSku} è¿›è¡Œå…³åŠ¡è¯„ä¼°å—ï¼Ÿ`);
    if (confirmed) {
        // æ›´æ–°å•†å“çŠ¶æ€
        updateProductStatus(domesticSku, 'customsStatus', 'pending-confirm');
        alert('å…³åŠ¡è¯„ä¼°å·²æäº¤ï¼ŒçŠ¶æ€æ›´æ–°ä¸ºå¾…ç¡®è®¤');
        
        // é‡æ–°åŠ è½½æ•°æ®
        loadTableData();
    }
}

// æ‰§è¡Œå…³åŠ¡ç¡®è®¤
function performCustomsConfirm(domesticSku) {
    console.log('æ‰§è¡Œå…³åŠ¡ç¡®è®¤:', domesticSku);
    
    const confirmed = confirm(`ç¡®å®šè¦ç¡®è®¤å•†å“ ${domesticSku} çš„å…³åŠ¡è¯„ä¼°ç»“æœå—ï¼Ÿ`);
    if (confirmed) {
        // æ›´æ–°å•†å“çŠ¶æ€
        updateProductStatus(domesticSku, 'customsStatus', 'confirmed');
        
        // åŒæ—¶æ›´æ–°æµ·å…³ç¼–ç å’Œç¨ç‡ä¿¡æ¯
        updateCustomsInfo(domesticSku);
        
        // æ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°å•†å“è¯„ä¼°çŠ¶æ€
        checkAndUpdateProductStatus(domesticSku);
        
        alert('å…³åŠ¡ç¡®è®¤å®Œæˆï¼Œæµ·å…³ç¼–ç å’Œç¨ç‡ä¿¡æ¯å·²æ›´æ–°');
        
        // é‡æ–°åŠ è½½æ•°æ®
        loadTableData();
    }
}

// æ‰§è¡Œè®¤è¯è¯„ä¼°
function performCertAssessment(domesticSku) {
    console.log('æ‰§è¡Œè®¤è¯è¯„ä¼°:', domesticSku);
    
    const confirmed = confirm(`ç¡®å®šè¦å¯¹å•†å“ ${domesticSku} è¿›è¡Œè®¤è¯è¯„ä¼°å—ï¼Ÿ`);
    if (confirmed) {
        // æ›´æ–°å•†å“çŠ¶æ€
        updateProductStatus(domesticSku, 'certStatus', 'submitted');
        
        // æ›´æ–°å¼ºåˆ¶æ€§è®¤è¯ä¿¡æ¯
        updateCertificationInfo(domesticSku);
        
        // æ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°å•†å“è¯„ä¼°çŠ¶æ€
        checkAndUpdateProductStatus(domesticSku);
        
        alert('è®¤è¯è¯„ä¼°å·²æäº¤ï¼Œå¼ºåˆ¶æ€§è®¤è¯ä¿¡æ¯å·²æ›´æ–°');
        
        // é‡æ–°åŠ è½½æ•°æ®
        loadTableData();
    }
}

// æ‰§è¡Œåˆ†é…æœåŠ¡å•†
function performAssignProvider(domesticSku) {
    console.log('åˆ†é…æœåŠ¡å•†:', domesticSku);
    
    const providers = ['ç§‘æ©˜', 'çŒèŠ¯'];
    const selectedProvider = prompt(`è¯·é€‰æ‹©æœåŠ¡å•†ï¼š\n1. ${providers[0]}\n2. ${providers[1]}\n\nè¯·è¾“å…¥æ•°å­— 1 æˆ– 2:`);
    
    if (selectedProvider === '1' || selectedProvider === '2') {
        const providerName = providers[parseInt(selectedProvider) - 1];
        updateProductStatus(domesticSku, 'serviceProvider', providerName);
        alert(`å·²å°†å•†å“ ${domesticSku} åˆ†é…ç»™æœåŠ¡å•†ï¼š${providerName}`);
        
        // é‡æ–°åŠ è½½æ•°æ®
        loadTableData();
    }
}

// æŸ¥çœ‹å•†å“è¯¦æƒ…
function viewProductDetail(domesticSku) {
    console.log('æŸ¥çœ‹å•†å“è¯¦æƒ…:', domesticSku);
    
    // è¿™é‡Œå¯ä»¥æ‰“å¼€è¯¦æƒ…å¼¹çª—æˆ–è·³è½¬åˆ°è¯¦æƒ…é¡µé¢
    alert(`æŸ¥çœ‹å•†å“è¯¦æƒ…åŠŸèƒ½å¼€å‘ä¸­...\nå•†å“SKU: ${domesticSku}`);
}

// åˆ é™¤å•†å“
function deleteProduct(domesticSku) {
    console.log('åˆ é™¤å•†å“:', domesticSku);
    
    const confirmed = confirm(`ç¡®å®šè¦åˆ é™¤å•†å“ ${domesticSku} å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ï¼`);
    if (confirmed) {
        // ä»æ•°æ®ä¸­åˆ é™¤å•†å“
        removeProductFromData(domesticSku);
        alert(`å•†å“ ${domesticSku} å·²åˆ é™¤`);
        
        // é‡æ–°åŠ è½½æ•°æ®
        loadTableData();
    }
}

// åˆå§‹åŒ–å…¨å±€æ•°æ®å­˜å‚¨
function initializeGlobalDataStore() {
    if (Object.keys(globalDataStore).length === 0) {
        globalDataStore = {
            china: generateChinaData(),
            thailand: generateThailandData(),
            vietnam: generateVietnamData(),
            malaysia: generateMalaysiaData(),
            indonesia: generateIndonesiaData(),
            hungary: generateHungaryData(),
            brazil: generateBrazilData()
        };
    }
}

// è·å–å½“å‰å›½å®¶çš„æ•°æ®
function getCurrentCountryData() {
    initializeGlobalDataStore();
    return globalDataStore[currentCountry] || [];
}

// æ›´æ–°å•†å“çŠ¶æ€
function updateProductStatus(domesticSku, field, value) {
    initializeGlobalDataStore();
    
    let data = globalDataStore[currentCountry] || [];
    const product = data.find(item => item.domesticSku === domesticSku);
    
    if (product) {
        product[field] = value;
        product.updateTime = new Date().toISOString().split('T')[0];
        product.updater = 'å½“å‰ç”¨æˆ·'; // å®é™…åº”ç”¨ä¸­åº”è¯¥æ˜¯å½“å‰ç™»å½•ç”¨æˆ·
        
        console.log(`å•†å“ ${domesticSku} çš„ ${field} å·²æ›´æ–°ä¸º: ${value}`);
    } else {
        console.error(`æœªæ‰¾åˆ°å•†å“: ${domesticSku}`);
    }
}

// æ›´æ–°æµ·å…³ç¼–ç å’Œç¨ç‡ä¿¡æ¯
function updateCustomsInfo(domesticSku) {
    initializeGlobalDataStore();
    
    let data = globalDataStore[currentCountry] || [];
    const product = data.find(item => item.domesticSku === domesticSku);
    
    if (product) {
        // æ¨¡æ‹Ÿç”Ÿæˆæµ·å…³ç¼–ç å’Œç¨ç‡ä¿¡æ¯
        product.hscode = `${Math.floor(Math.random() * 90000000) + 10000000}`;
        
        // æ ¹æ®ä¸åŒå›½å®¶æ›´æ–°å¯¹åº”çš„ç¨ç‡å­—æ®µ
        switch (currentCountry) {
            case 'china':
                product.exportTaxRate = `${(Math.random() * 15).toFixed(1)}%`;
                product.exportTariffRate = `${(Math.random() * 10).toFixed(1)}%`;
                break;
                
            case 'thailand':
            case 'vietnam':
                product.importTariffRate = `${(Math.random() * 25).toFixed(1)}%`;
                product.vatRate = `${(Math.random() * 12 + 3).toFixed(1)}%`;
                break;
                
            case 'malaysia':
                product.mfnRate = `${(Math.random() * 20).toFixed(1)}%`;
                product.formE = Math.random() > 0.5 ? 'é€‚ç”¨' : 'ä¸é€‚ç”¨';
                product.sst = `${(Math.random() * 10).toFixed(1)}%`;
                product.antiDumping = Math.random() > 0.8 ? `${(Math.random() * 50).toFixed(1)}%` : 'æ— ';
                break;
                
            case 'indonesia':
                product.formE = Math.random() > 0.5 ? 'é€‚ç”¨' : 'ä¸é€‚ç”¨';
                product.ppn = `${(Math.random() * 11 + 10).toFixed(1)}%`;
                product.pph = `${(Math.random() * 5 + 2).toFixed(1)}%`;
                product.ppnbm = Math.random() > 0.7 ? `${(Math.random() * 75 + 25).toFixed(1)}%` : 'æ— ';
                product.bmt = `${(Math.random() * 10).toFixed(1)}%`;
                break;
                
            case 'hungary':
                product.importDuty = `${(Math.random() * 15).toFixed(1)}%`;
                product.antiDumping = Math.random() > 0.8 ? `${(Math.random() * 50).toFixed(1)}%` : 'æ— ';
                product.countervailing = Math.random() > 0.9 ? `${(Math.random() * 30).toFixed(1)}%` : 'æ— ';
                product.vat = `${(Math.random() * 8 + 20).toFixed(1)}%`;
                break;
                
            case 'brazil':
                product.ii = `${(Math.random() * 35).toFixed(1)}%`;
                product.ipi = `${(Math.random() * 30).toFixed(1)}%`;
                product.pis = `${(Math.random() * 2 + 1).toFixed(2)}%`;
                product.confins = `${(Math.random() * 8 + 3).toFixed(2)}%`;
                product.icms = `${(Math.random() * 8 + 17).toFixed(1)}%`;
                product.antiDumping = Math.random() > 0.8 ? `${(Math.random() * 50).toFixed(1)}%` : 'æ— ';
                break;
                
            default:
                // é»˜è®¤æƒ…å†µï¼Œä½¿ç”¨é€šç”¨å­—æ®µ
                product.importTariffRate = `${(Math.random() * 25).toFixed(1)}%`;
                product.vatRate = `${(Math.random() * 12 + 3).toFixed(1)}%`;
                break;
        }
        
        product.isControlled = Math.random() > 0.8;
        product.controlInfo = product.isControlled ? 'éœ€è¦ç›¸å…³è®¸å¯è¯' : '';
        
        console.log(`å·²æ›´æ–°å•†å“ ${domesticSku} åœ¨ ${currentCountry} çš„ç¨ç‡ä¿¡æ¯`);
    }
}

// æ›´æ–°å¼ºåˆ¶æ€§è®¤è¯ä¿¡æ¯
function updateCertificationInfo(domesticSku) {
    initializeGlobalDataStore();
    
    let data = globalDataStore[currentCountry] || [];
    const product = data.find(item => item.domesticSku === domesticSku);
    
    if (product) {
        // æ¨¡æ‹Ÿæ›´æ–°å¼ºåˆ¶æ€§è®¤è¯ä¿¡æ¯
        // è¿™é‡Œå¯ä»¥æ·»åŠ å…·ä½“çš„è®¤è¯ä¿¡æ¯å­—æ®µ
        console.log(`æ›´æ–°å•†å“ ${domesticSku} çš„å¼ºåˆ¶æ€§è®¤è¯ä¿¡æ¯`);
    }
}

// æ£€æŸ¥å¹¶æ›´æ–°å•†å“è¯„ä¼°çŠ¶æ€
function checkAndUpdateProductStatus(domesticSku) {
    initializeGlobalDataStore();
    
    let data = globalDataStore[currentCountry] || [];
    const product = data.find(item => item.domesticSku === domesticSku);
    
    if (product) {
        // åªæœ‰å½“å…³åŠ¡è¯„ä¼°çŠ¶æ€å·²ç¡®è®¤ï¼Œä¸”è®¤è¯è¯„ä¼°çŠ¶æ€å·²æäº¤æ—¶ï¼Œå•†å“è¯„ä¼°çŠ¶æ€æ‰å˜æˆå·²ç”Ÿæ•ˆ
        if (product.customsStatus === 'confirmed' && product.certStatus === 'submitted') {
            product.productStatus = 'active';
            console.log(`å•†å“ ${domesticSku} è¯„ä¼°çŠ¶æ€å·²æ›´æ–°ä¸ºå·²ç”Ÿæ•ˆ`);
        }
    }
}

// ä»æ•°æ®ä¸­åˆ é™¤å•†å“
function removeProductFromData(domesticSku) {
    initializeGlobalDataStore();
    
    let data = globalDataStore[currentCountry] || [];
    const index = data.findIndex(item => item.domesticSku === domesticSku);
    
    if (index !== -1) {
        data.splice(index, 1);
        console.log(`ä»æ•°æ®ä¸­åˆ é™¤å•†å“: ${domesticSku}`);
    } else {
        console.error(`æœªæ‰¾åˆ°è¦åˆ é™¤çš„å•†å“: ${domesticSku}`);
    }
}
// å¤é€‰æ¡†åŠŸèƒ½
function toggleSelectAll(checkbox) {
    const rowCheckboxes = document.querySelectorAll('.row-checkbox');
    rowCheckboxes.forEach(cb => {
        cb.checked = checkbox.checked;
    });
}

// æŸ¥è¯¢è¡¨å•å±•å¼€/æ”¶èµ·åŠŸèƒ½
// ç»‘å®šå±•å¼€/æ”¶èµ·æŒ‰é’®äº‹ä»¶
function bindToggleEvents() {
    const toggleBtn = document.getElementById('search-toggle');
    if (toggleBtn) {
        toggleBtn.addEventListener('click', toggleSearchForm);
    }
}

// çŠ¶æ€TABå’ŒæŸ¥è¯¢ç»„ä»¶è”åŠ¨åŠŸèƒ½
function initStatusTabLinkage() {
    const statusTabs = document.querySelectorAll('.status-tab');
    const customsStatusSelect = document.getElementById('customs-status');
    const certStatusSelect = document.getElementById('cert-status');
    const hasOrderSelect = document.getElementById('has-order');
    
    statusTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            const status = this.getAttribute('data-status');
            
            // é‡ç½®æ‰€æœ‰selectåˆ°placeholderçŠ¶æ€
            resetSelectToPlaceholder(customsStatusSelect);
            resetSelectToPlaceholder(certStatusSelect);
            resetSelectToPlaceholder(hasOrderSelect);
            
            // æ ¹æ®çŠ¶æ€TABæ›´æ–°é€‰é¡¹
            switch(status) {
                case 'customs-pending':
                    // å…³åŠ¡æœªè¯„ä¼°ï¼šå…³åŠ¡è¯„ä¼°çŠ¶æ€åªç•™ä¸‹å¾…æäº¤å’Œå¾…ç¡®è®¤
                    updateSelectOptions(customsStatusSelect, [
                        {value: 'pending-submit', text: 'å¾…æäº¤'},
                        {value: 'pending-confirm', text: 'å¾…ç¡®è®¤'}
                    ]);
                    break;
                    
                case 'cert-pending':
                    // è®¤è¯æœªè¯„ä¼°ï¼šå¼ºåˆ¶æ€§è®¤è¯è¯„ä¼°çŠ¶æ€åªç•™ä¸‹å¾…æäº¤
                    updateSelectOptions(certStatusSelect, [
                        {value: 'pending-submit', text: 'å¾…æäº¤'}
                    ]);
                    break;
                    
                case 'element-pending':
                    // è¦ç´ æœªç¡®è®¤ï¼šæ˜¯å¦äº§ç”Ÿè®¢å•åªç•™ä¸‹æ˜¯
                    updateSelectOptions(hasOrderSelect, [
                        {value: 'yes', text: 'æ˜¯'}
                    ]);
                    break;
                    
                default:
                    // æ¢å¤æ‰€æœ‰é€‰é¡¹
                    restoreAllSelectOptions();
                    break;
            }
        });
    });
}

function resetSelectToPlaceholder(select) {
    if (select) {
        select.value = '';
        select.style.color = '#999';
    }
}



}}
